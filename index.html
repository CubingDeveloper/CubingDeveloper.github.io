<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CubingDeveloper</title>
    <style>
/*
Global 
*/

/**
Imports/Animations
**/
@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&display=swap');
@keyframes appear {
  0% {
        position: relative;
        opacity: 0;
        top: 50%;
    }
  100% {
        position: relative;
        opacity: 1;
        top: 0;
        }
}

/**
Global styles
**/
* {
    margin: 0;
    padding: 0;
    font-family: "Space Grotesk", serif;
    text-decoration: none;   
}

:root {
    /***
    Colo(u)rs
    **/
    --color-secondary: #0d1b2a;
    --color-primary: #1b263b;
    --color-font: #dff1f1;
    --color-font-secondary: #c2ecec;

    /***
    Sizes
    ***/
    --font-size-xl: clamp(2vw, 16px, 100px);
    --font-size-xxl: clamp(4vw, 16px, 100px);
    --font-size-xxxl: clamp(6vw, 16px, 100px);
}

a {color: inherit;}

body {
    width: 100vw;
    height: 100vh;
    display: flex;
    flex-direction: column;
    background: var(--color-primary);
    overflow-x: hidden;
}

/* 
Navbar settings 
*/
.top-navbar {
    height: 7.5vh;
    background-color: var(--color-secondary);
    color: var(--color-font);
    width: 100vw;
}
.top-navbar ul {
    width:100%;
    height:100%;
    display: flex;
    flex-direction: row;
    gap: 20px;
    padding-left: 1%;
    padding-right: 1%;
    font-size: var(--font-size-xl);
    list-style-type: none;
}
.top-navbar ul li {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/*
Main content
*/
.main-content {
    display:flex;
    flex-direction: column;
    align-items: center;
    width:100%;
    height: auto;
}
.main-title {
    padding-top: 20px;
    color: var(--color-font);
    font-size: var(--font-size-xxxl);
    padding-bottom: 20px;
}
.paragraph {
    color: var(--color-font-secondary);
    font-size: var(--font-size-xl);
    text-align: center;
}
    </style>
</head>
<body>
    <nav class="top-navbar">
        <ul>
            <li>
                <strong><a href="/">CubingDeveloper</a></strong>
            </li>
            <li><a href="/contact">Contact</a></li>
            <li><a href="/projects">Projects</a></li>
        </ul>
    </nav>
    <main class="main-content">
        <h1 class="type-effect main-title" type-text="CubingDeveloper"></h1>
        <p class="appear-effect paragraph" appear-duration="0.5">

            <span do-appear-effect="true" appear-delay="0.5s">Hi, I'm CubingDeveloper, a passionate developer from Sweden.</span><br>
            <span do-appear-effect="true" appear-delay="0.75s">I'm deeply interested in creating games and exploring new technologies.</span><br>
            <span do-appear-effect="true" appear-delay="1s">When I'm not coding, I enjoy playing piano and chess.</span><br>

        </p>
    </main>
    <script>

function typeEffect(element, text, speed = 1) {
    let index = 0;
    const speedMultiplier = 1/(speed||1)
    function type() {
        if (index < text.length) {
            element.textContent = element.textContent.slice(0, -1) + text[index] + "|";
            index++;
            setTimeout(type, 50*speedMultiplier);
            return
        }
        element.textContent = element.textContent.slice(0, -1)

    }
    type();
}

function playProperEffect(element){
    if (element.classList.contains("type-effect")){
        if (element.dataset.typed) return

        element.dataset.typed = "true";
        const text = element.getAttribute("type-text");
        const speed = element.getAttribute("type-speed")
        typeEffect(element, text, speed);
            
    } else if (element.classList.contains("appear-effect")) {
        if (element.dataset.appeared) return
        
        var appearDuration = `${element.getAttribute("appear-duration") || 1}s`

        element.dataset.appeared = "true";
        console.log(element.childNodes)
        element.childNodes.forEach((v, k) => {
            if (v.nodeName == "#text") return
            if (v.getAttribute("do-appear-effect")) {
                console.log("Adding effect!!", v)

                v.style.opacity = 0
                v.style["animation-name"] = "appear"
                v.style["animation-duration"] = appearDuration
                v.style["animation-timing-function"] = "ease-in-out"
                v.style["animation-delay"] = `${v.getAttribute("appear-delay")}`
                v.style["animation-fill-mode"] = "forwards"
            }
        })

    }
}



const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            playProperEffect(entry.target)
        }
    });
}, { threshold: 0.5 }); // Trigger when 50% visible

// Select all elements you want to apply the typing effect to
const targets = document.querySelectorAll('.type-effect, .appear-effect'); 

// Observe each element in the NodeList
targets.forEach(target => {
    observer.observe(target);
});

// Check if any element is already visible on load
window.addEventListener('load', () => {
    targets.forEach(target => {
        if (target.getBoundingClientRect().top < window.innerHeight * 0.5) {
            // Element is already visible, trigger the typing effect
            playProperEffect(target)
        }
    });
});
    </script>
</body>
</html>